<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
	
<mapper namespace="com.example.shopping.dao.ICategoryMapper">

	<insert id="insert">
		 insert into category
 		 values(cate_seq.NEXTVAL,#{code},#{cname})
	</insert>
	
	<select id="list" resultType="com.example.shopping.vo.CategoryVO">
		select * from category OFFSET #{startPage} ROWS FETCH FIRST #{countPerPage} ROWS ONLY 
	</select>
	
	<select id="allList" resultType="com.example.shopping.vo.CategoryVO">
		select * from category
	</select>
	
	
	<select id="countAllList" resultType="int">
		select count(*) from category
	</select>
	
	<select id="select" resultType="com.example.shopping.vo.CategoryVO">
		select * from category where cnum=#{num}
	</select>
	
	<update id="update">
		update category set cname=#{cname} where cnum=#{cnum}
	</update>
	
	<delete id="delete">
		delete from category where cnum=#{num}
	</delete>
	
	<insert id="insertGoods">
		insert into product values(prod_seq.nextval, #{pname}, #{pcode}, #{pcompany}, #{price},
			#{pspec}, #{pcontent}, #{pimage}, 0, #{point}, #{sale}) 
	</insert>
	
	<select id="allGoodsList" resultType="com.example.shopping.vo.GoodsVO">
		select * from product
	</select>
	
	<select id="countAllGoods" resultType="int">
		select count(*) from product 
	</select>
	
	<select id="goodsList" resultType="com.example.shopping.vo.GoodsVO">
		SELECT * FROM product OFFSET #{startPage} ROWS FETCH FIRST #{countPerPage} ROWS ONLY
	</select>
	
	<select id="selectGoods" resultType="com.example.shopping.vo.GoodsVO">
		select * from product where pnum = #{num}
	</select>
	
	<update id="updateGoods">
		update product set pname=#{pname}, pcompany=#{pcompany}, price=#{price},
		pspec=#{pspec}, sale=#{sale}, pcontent=#{pcontent} , 
		pimage=#{pimage}, point=#{point} where pnum=#{pnum}
	</update>
	
	<delete id="deleteGoods">
		delete from product where pnum = #{num}
	</delete>
	
	<select id="findCategoryGoods" resultType="com.example.shopping.vo.GoodsVO">
		select * from product where 
			${condition} like (select A.code from 
			(select * from category where cname=#{search})A)||'%'
	</select>
	
	<select id="findNameGoods" resultType="com.example.shopping.vo.GoodsVO">
		select * from product where ${condition} like '%'||#{search}||'%'
	</select>
	
</mapper>